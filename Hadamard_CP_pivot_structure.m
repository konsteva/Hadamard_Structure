H1 = [
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 ;
1 -1 1 -1 1 -1 1 -1 1 -1 1 -1 1 -1 1 -1;
1 1 -1 -1 1 1 -1 -1 1 1 -1 -1 1 1 -1 -1;
1 -1 -1 1 1 -1 -1 1 1 -1 -1 1 1 -1 -1 1;
1 1 1 1 -1 -1 -1 -1 1 1 1 1 -1 -1 -1 -1;
1 -1 1 -1 -1 1 -1 1 1 -1 1 -1 -1 1 -1 1;
1 1 -1 -1 -1 -1 1 1 1 1 -1 -1 -1 -1 1 1;
1 -1 -1 1 -1 1 1 -1 1 -1 -1 1 -1 1 1 -1;
1 1 1 1 1 1 1 1 -1 -1 -1 -1 -1 -1 -1 -1;
1 -1 1 -1 1 -1 1 -1 -1 1 -1 1 -1 1 -1 1;
1 1 -1 -1 1 1 -1 -1 -1 -1 1 1 -1 -1 1 1;
1 -1 -1 1 1 -1 -1 1 -1 1 1 -1 -1 1 1 -1;
1 1 1 1 -1 -1 -1 -1 -1 -1 -1 -1 1 1 1 1;
1 -1 1 -1 -1 1 -1 1 -1 1 -1 1 1 -1 1 -1;
1 1 -1 -1 -1 -1 1 1 -1 -1 1 1 1 1 -1 -1;
1 -1 -1 1 -1 1 1 -1 -1 1 1 -1 1 -1 -1 1] ;

H2 = [
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 ;
1 -1 1 -1 1 -1 1 -1 1 -1 1 -1 1 -1 1 -1 ;
1 1 -1 -1 1 1 -1 -1 1 1 -1 -1 1 1 -1 -1 ;
1 -1 -1 1 1 -1 -1 1 1 -1 -1 1 1 -1 -1 1;
1 1 1 1 -1 -1 -1 -1 1 1 1 1 -1 -1 -1 -1 ;
1 -1 1 -1 -1 1 -1 1 1 -1 1 -1 -1 1 -1 1;
1 1 -1 -1 -1 -1 1 1 1 1 -1 -1 -1 -1 1 1;
1 -1 -1 1 -1 1 1 -1 1 -1 -1 1 -1 1 1 -1;
1 1 1 1 1 1 1 1 -1 -1 -1 -1 -1 -1 -1 -1;
1 -1 1 -1 1 -1 -1 1 -1 1 -1 1 -1 1 1 -1;
1 1 -1 -1 1 1 -1 -1 -1 -1 1 1 -1 -1 1 1;
1 -1 -1 1 1 -1 1 -1 -1 1 1 -1 -1 1 -1 1;
1 1 1 1 -1 -1 -1 -1 -1 -1 -1 -1 1 1 1 1 ;
1 -1 1 -1 -1 1 1 -1 -1 1 -1 1 1 -1 -1 1;
1 1 -1 -1 -1 -1 1 1 -1 -1 1 1 1 1 -1 -1 ;
1 -1 -1 1 -1 1 -1 1 -1 1 1 -1 1 -1 1 -1 ] ;

H3 = [
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1;
1 -1 1 -1 1 -1 1 -1 1 -1 1 -1 1 -1 1 -1;
1 1 -1 -1 1 1 -1 -1 1 1 -1 -1 1 1 -1 -1;
1 -1 -1 1 1 -1 -1 1 1 -1 -1 1 1 -1 -1 1;
1 1 1 1 -1 -1 -1 -1 1 1 1 1 -1 -1 -1 -1 ;
1 -1 1 -1 -1 1 -1 1 1 -1 1 -1 -1 1 -1 1;
1 1 -1 -1 -1 -1 1 1 1 1 -1 -1 -1 -1 1 1;
1 -1 -1 1 -1 1 1 -1 1 -1 -1 1 -1 1 1 -1 ;
1 1 1 1 1 1 1 1 -1 -1 -1 -1 -1 -1 -1 -1;
1 1 1 1 -1 -1 -1 -1 -1 -1 -1 -1 1 1 1 1 ;
1 1 -1 -1 1 -1 1 -1 -1 -1 1 1 -1 1 -1 1;
1 1 -1 -1 -1 1 -1 1 -1 -1 1 1 1 -1 1 -1 ;
1 -1 1 -1 1 -1 -1 1 -1 1 -1 1 -1 1 1 -1;
1 -1 1 -1 -1 1 1 -1 -1 1 -1 1 1 -1 -1 1;
1 -1 -1 1 1 1 -1 -1 -1 1 1 -1 -1 -1 1 1;
1 -1 -1 1 -1 -1 1 1 -1 1 1 -1 1 1 -1 -1 ] ;

H4 = [
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1;
1 -1 1 -1 1 -1 1 -1 1 -1 1 -1 1 -1 1 -1;
1 1 -1 -1 1 1 -1 -1 1 1 -1 -1 1 1 -1 -1;
1 -1 -1 1 1 -1 -1 1 1 -1 -1 1 1 -1 -1 1;
1 1 1 1 -1 -1 -1 -1 1 1 1 1 -1 -1 -1 -1 ;
1 -1 1 -1 -1 1 -1 1 1 -1 1 -1 -1 1 -1 1;
1 1 -1 -1 -1 -1 1 1 1 1 -1 -1 -1 -1 1 1;
1 -1 -1 1 -1 1 1 -1 1 -1 -1 1 -1 1 1 -1;
1 1 1 1 1 1 1 1 -1 -1 -1 -1 -1 -1 -1 -1;
1 1 1 -1 1 -1 -1 -1 -1 -1 -1 1 -1 1 1 1 ;
1 1 -1 1 -1 -1 -1 1 -1 -1 1 -1 1 1 1 -1;
1 1 -1 -1 -1 1 1 -1 -1 -1 1 1 1 -1 -1 1 ;
1 -1 1 1 -1 1 -1 -1 -1 1 -1 -1 1 -1 1 1;
1 -1 1 -1 -1 -1 1 1 -1 1 -1 1 1 1 -1 -1;
1 -1 -1 1 1 -1 1 -1 -1 1 1 -1 -1 1 -1 1;
1 -1 -1 -1 1 1 -1 1 -1 1 1 1 -1 -1 1 -1] ;

H5 = [
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1;
1 -1 1 -1 1 -1 1 -1 1 1 1 1 -1 -1 -1 -1;
1 1 -1 -1 1 1 -1 -1 1 1 -1 -1 1 1 -1 -1 ;
1 -1 -1 1 1 -1 -1 1 1 -1 1 -1 1 -1 1 -1;
1 1 1 1 -1 -1 -1 -1 1 1 -1 -1 -1 -1 1 1 ;
1 -1 1 -1 -1 1 -1 1 1 -1 -1 1 1 -1 -1 1;
1 1 -1 -1 -1 -1 1 1 1 -1 -1 1 -1 1 1 -1 ;
1 -1 -1 1 -1 1 1 -1 1 -1 1 -1 -1 1 -1 1;
1 1 1 1 1 1 1 1 -1 -1 -1 -1 -1 -1 -1 -1;
1 -1 1 -1 1 -1 1 -1 -1 -1 -1 -1 1 1 1 1 ;
1 1 -1 -1 1 1 -1 -1 -1 -1 1 1 -1 -1 1 1 ;
1 -1 -1 1 1 -1 -1 1 -1 1 -1 1 -1 1 -1 1;
1 1 1 1 -1 -1 -1 -1 -1 -1 1 1 1 1 -1 -1;
1 -1 1 -1 -1 1 -1 1 -1 1 1 -1 -1 1 1 -1;
1 1 -1 -1 -1 -1 1 1 -1 1 1 -1 1 -1 -1 1 ;
1 -1 -1 1 -1 1 1 -1 -1 1 -1 1 1 -1 1 -1] ;

H1_pivots_CP = [];
H2_pivots_CP = [];
H3_pivots_CP = [];
H4_pivots_CP = [];
H5_pivots_CP = [];

% First line has the pivot pattern of the class representantives
H1_pivots_CP(1,:) = pivot_structure_CP(H1);
H2_pivots_CP(1,:) = pivot_structure_CP(H2);
H3_pivots_CP(1,:) = pivot_structure_CP(H3);
H4_pivots_CP(1,:) = pivot_structure_CP(H4);
H5_pivots_CP(1,:) = pivot_structure_CP(H5);

% Display pivot pattern
disp("Pivot pattern of representative of class 1:")
disp(H1_pivots_CP)
disp("Pivot pattern of representative of class 2:")
disp(H2_pivots_CP)
disp("Pivot pattern of representative of class 3:")
disp(H3_pivots_CP)
disp("Pivot pattern of representative of class 4:")
disp(H4_pivots_CP)
disp("Pivot pattern of representative of class 5:")
disp(H5_pivots_CP)

tic;

% Create m random equivalent matrices
for i=2:20000 %m=15.000
  [H] = Equivalent_Hadamard(H1);
  H1_pivots_CP(i,:) = pivot_structure_CP(H);
  [H] = Equivalent_Hadamard(H2);
  H2_pivots_CP(i,:) = pivot_structure_CP(H);
  [H] = Equivalent_Hadamard(H3);
  H3_pivots_CP(i,:) = pivot_structure_CP(H);
  [H] = Equivalent_Hadamard(H4);
  H4_pivots_CP(i,:) = pivot_structure_CP(H);
  [H] = Equivalent_Hadamard(H5);
  H5_pivots_CP(i,:) = pivot_structure_CP(H);
end

% Delete duplicate patterns and put the rest in ascending order
H1_pivots_CP = uniquetol(H1_pivots_CP,0.00001,'ByRows',true);
H2_pivots_CP = uniquetol(H2_pivots_CP,0.00001,'ByRows',true);
H3_pivots_CP = uniquetol(H3_pivots_CP,0.00001,'ByRows',true);
H4_pivots_CP = uniquetol(H4_pivots_CP,0.00001,'ByRows',true);
H5_pivots_CP = uniquetol(H5_pivots_CP,0.00001,'ByRows',true);

% Display the patterns of each class
disp("H1 pivot structures")
disp(H1_pivots_CP)
disp("H2 pivot structures")
disp(H2_pivots_CP)
disp("H3 pivot structures")
disp(H3_pivots_CP)
disp("H4 pivot structures")
disp(H4_pivots_CP)
disp("H5 pivot structures")
disp(H5_pivots_CP)


% Compute and display the number of different structures
l1 = length(H1_pivots_CP(:,1));
disp("Num of pivot patterns of class 1:")
disp(l1)

l2 = length(H2_pivots_CP(:,1));
disp("Num of pivot patterns of class 2:")
disp(l2)

l3 = length(H3_pivots_CP(:,1));
disp("Num of pivot patterns of class 3:")
disp(l3)

l4 = length(H4_pivots_CP(:,1));
disp("Num of pivot patterns of class 4:")
disp(l4)

l5 = length(H5_pivots_CP(:,1));
disp("Num of pivot patterns of class 5:")
disp(l5)

format short
t = toc
